name: Deploy Theme

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  validate:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
      
    - name: Validate CSS
      run: |
        echo "Checking CSS file exists..."
        if [ ! -f "jellyfin-overseerr.css" ]; then
          echo "Error: jellyfin-overseerr.css not found!"
          exit 1
        fi
        echo "✅ CSS file found"
        
    - name: Validate HTML
      run: |
        echo "Checking HTML file exists..."
        if [ ! -f "index.html" ]; then
          echo "Error: index.html not found!"
          exit 1
        fi
        echo "✅ HTML file found"
        
    - name: Validate Assets
      run: |
        echo "Checking assets folder..."
        if [ ! -d "assets" ]; then
          echo "Error: assets folder not found!"
          exit 1
        fi
        if [ ! -f "assets/logo.svg" ]; then
          echo "Error: logo.svg not found!"
          exit 1
        fi
        if [ ! -f "assets/bg.svg" ]; then
          echo "Error: bg.svg not found!"
          exit 1
        fi
        echo "✅ All assets found"
        
    - name: Check file sizes
      run: |
        echo "Checking file sizes..."
        CSS_SIZE=$(wc -c < jellyfin-overseerr.css)
        if [ $CSS_SIZE -gt 50000 ]; then
          echo "Warning: CSS file is larger than 50KB"
        else
          echo "✅ CSS file size: $CSS_SIZE bytes"
        fi
        
    - name: Validate URLs
      run: |
        echo "Checking for placeholder URLs..."
        if grep -q "YOUR_GITHUB_USERNAME" jellyfin-overseerr.css; then
          echo "⚠️ Warning: Found placeholder 'YOUR_GITHUB_USERNAME' in CSS"
          echo "Remember to replace it with your actual GitHub username!"
        else
          echo "✅ No placeholder URLs found"
        fi
        
    - name: Success
      run: |
        echo "✅ All validation checks passed!"
        echo "Theme is ready for deployment!"
